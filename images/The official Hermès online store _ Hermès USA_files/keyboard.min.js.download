!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):((e="undefined"!=typeof globalThis?globalThis:e||self).flowplayer=e.flowplayer||{},e.flowplayer.keyboard=t())}(this,(function(){"use strict";function e(e,t,n){const i=function(e){return Array.isArray(e)?e.slice(0):e.split(".")}(t);for(;i.length;){if(null==e)return n;const t=i.shift();if("string"!=typeof t)return n;e=e[t]}return null==e?n:e}var t={TAB:9,ENTER:13,ESCAPE:27,SPACE:32,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,F:70,H:72,J:74,K:75,L:76,M:77};var n=void 0;function i(e){e.setState("is-kb-active",!0),clearTimeout(n),n=setTimeout((function(){e.setState("is-kb-active",!1)}),2500)}function r(e,t){e.enqueueSeek(t)&&i(e)}let o=void 0;const u=[t.ARROW_UP,t.ARROW_RIGHT,t.ARROW_LEFT,t.ARROW_DOWN],a=[t.SPACE,t.F,t.ESCAPE,t.M,t.ARROW_UP,t.ARROW_DOWN,t.ARROW_RIGHT,t.ARROW_LEFT,t.H,t.J,t.K,t.L];function s(e,t){e.volume=function(e,t,n=0){return Math.max(Math.min(t,e),n)}(e.volume+t,1,0),i(e)}function f(e,t){return!(t.altKey||t.shiftKey||t.metaKey||t.ctrlKey)&&(!!(e&&e.in_viewport&&e.started)&&(!!e.root&&(function(e){var t=document.activeElement;for(;t;){if(t===e)return!0;t=t.parentElement}return!1}(e.root)||document.activeElement===document.body)))}function l(e){e.preventDefault(),e.stopPropagation()}function c(e,t){return!!R(e,t)}function R(e,t){return!!e.parentElement&&(e.parentElement.matches(t)?e.parentElement:c(e.parentElement,t))}return document.addEventListener("keydown",(function(n){setTimeout((function(){n.defaultPrevented||function(n){var i=n.which,p=o,A=e(p,"opts.keyboard.seek_step",5),d=document.activeElement;if(d&&p){if((i===t.SPACE||i===t.ENTER)&&d.hasAttribute("tabindex")&&c(d,".flowplayer"))return d.dispatchEvent(new MouseEvent("click",{bubbles:!0})),l(n);if(~u.indexOf(i)&&d.hasAttribute("aria-valuenow")){var m=~[t.ARROW_UP,t.ARROW_RIGHT].indexOf(i);if(d.matches(".fp-volume"))return s(p,m?.15:-.15),l(n);if(d.matches(".fp-timeline"))return r(p,m?A:-1*A),l(n)}if((i===t.ARROW_DOWN||i===t.ARROW_UP||i===t.ESCAPE)&&c(d,".fp-menu"))return n.preventDefault(),i===t.ARROW_DOWN&&d.nextSibling&&d.nextSibling.focus(),i===t.ARROW_UP&&d.previousSibling&&d.nextSibling.focus(),void(i===t.ESCAPE&&p.root.emit("menu:toggle:open",{open:!1,menu:R(d,".fp-menu")}));if(i===t.TAB){const e=window.flowplayer;e&&Array.isArray(e.instances)&&e.instances.forEach((function(e){e.setState("is-hovered",!0),e.setState("is-accessibility",!0)}))}if(f(p,n)){var E=!p.hasState("no-timeline");switch(~a.indexOf(i)&&n.preventDefault(),i){case t.SPACE:return p.togglePlay();case t.F:return p.toggleFullScreen();case t.ESCAPE:return p.toggleFullScreen(!1);case t.M:return p.toggleMute();case t.ARROW_UP:case t.K:return s(p,.15);case t.ARROW_DOWN:case t.J:return s(p,-.15);case t.ARROW_RIGHT:case t.L:return E&&r(p,A);case t.ARROW_LEFT:case t.H:E&&r(p,-1*A)}}}}(n)}),0)})),function(e,t){if("object"==typeof exports&&"undefined"!=typeof module)return t;"flowplayer"in e||(e.flowplayer={extensions:[]});var n=e.flowplayer;return"function"==typeof n?(n(t),t):(Array.isArray(n.extensions)||(n.extensions=[]),~n.extensions.indexOf(t)||n.extensions.push(t),t)}(window,(function(e,t,n){n.on(["loadstart","playing","fullscreenenter"],(function(){o=n}))}))}));
