!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):((t="undefined"!=typeof globalThis?globalThis:t||self).flowplayer=t.flowplayer||{},t.flowplayer.qsel=e())}(this,(function(){"use strict";const t=[].slice;function e(t,e,...n){return Object.assign(t,e)}function n(...t){return t.slice(1).reduce((t,n)=>e(t,n),t[0]||{})}function i(t,e,n){const i=function(t){return Array.isArray(t)?t.slice(0):t.split(".")}(e);for(;i.length;){if(null==t)return n;const e=i.shift();if("string"!=typeof e)return n;t=t[e]}return null==t?n:t}const o=!!function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(t){}return t}()&&{passive:!0},r=["touchstart","touchmove"];function a(t){var n=t;return n.emit=function(t,i,o={}){const r=function(t){const e=document.createEvent("Event");return e.initEvent(t,!1,!0),e}(t);return i&&e(r,{data:i||{}}),n.dispatchEvent(r),!1===o.return_self?r:n},n.on=function(t,e){return"string"==typeof t&&(t=t.split(" ")),t.forEach((function(t){return function(t){return~r.indexOf(t)}(t)?n.addEventListener(t,e,o):n.addEventListener(t,e)})),n},n.off=function(t,e){return n.removeEventListener(t,e),n},n.one=n.once=function(t,e){return n.on(t,(function i(o){n.off(t,i),e(o)}))},n}const s=Array.isArray,u="undefined"!=typeof window&&a(window),l="undefined"!=typeof document&&a(document),f=["span","a","em","p","i"];function c(t,e,n){var i=p(document.createElement(t));if(s(e)&&(n=e,e=!1),n||(n=[]),n&&!s(n)&&(n=[n]),n.length&&n.filter(t=>!!t).forEach(t=>i.append(t)),"object"!=typeof e)return i;for(var o in e)o in i?i[o]=e[o]:i.setAttribute(o,e[o]);return i}function d(e){var n=e.tagName;e.__flowplayer__=1,e.find=function(t){var n=e.querySelector(t);return n?p(n):n},e.html=function(t){return e.innerHTML=t,e},e.empty=function(){return e.innerHTML="",e},e.offset=function(){var t={top:0,left:0},n=e;do{t.left+=n.offsetLeft||0,t.top+=n.offsetTop||0}while(n=n.offsetParent);return t},e.innerWidth=function(){var t=getComputedStyle(e);return e.clientWidth-parseFloat(t.paddingLeft)-parseFloat(t.paddingRight)};var i=e.insert=function(t,n){return n?s(n)?n.map((function(n){return e.insert(t,n)}))[0]:p(n="string"==typeof n?e.insertAdjacentHTML(t,n):e.insertAdjacentElement?e.insertAdjacentElement(t,n):e.appendChild(n)):n};return e.append=i.bind(e,"beforeend"),e.prepend=i.bind(e,"afterbegin"),e.css=function(t,n){return"object"==typeof t?(Object.entries(t).forEach(([t,n])=>e.css(t,n)),e):void 0===n&&"string"==typeof t?getComputedStyle(e)[t]:("number"==typeof n&&(n+="px"),e.style[t]=n,e)},e.show=function(){return e.css({display:~f.indexOf(n)?"inline":"block"})},e.hide=function(){return e.css({display:"none"})},e.remove=function(){var t=e.parentNode;t&&t.removeChild(e)},e.attr=function(t,n){return null==n?e.getAttribute(t):(e.setAttribute(t,n),e)},e.txt=function(t){return e.textContent=t,e},e.fp=function(t){return e.addClass("fp-"+t)},e.addClass=function(t){return t.split(" ").forEach((function(t){e.hasClass(t)||(e.className+=(e.className?" ":"")+t)})),e},e.removeClass=function(t){const n=t.split(" ");var i=e.className.split(" ");return e.className=i.filter((function(t){return!~n.indexOf(t)})).join(" "),e},e.toggleClass=function(t,n){return void 0===n&&(n=!e.hasClass(t)),n?e.addClass(t):e.removeClass(t)},e.findAll=function(n){return i=e.querySelectorAll(n),t.call(i);var i},e.hasClass=function(t){return~e.className.split(" ").indexOf(t)},e}function p(t){return void 0===t||function(t){return t&&t.__flowplayer__}(t)?t:d(a(t))}function m(t,e){if("string"==typeof t&&"<"==t[0])return c(t.slice(1,-1),e);if("string"!=typeof t)return p(t);var n=e instanceof HTMLElement&&e.querySelector(".fp-"+t)||document.querySelector(t);return n?p(n):void 0}const v=t=>(e,n)=>("string"==typeof e&&(e={class:e}),c(t,e,n));function h(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function y(t){var e,n,i=h("svg");return i.setAttribute("viewBox",t.coords),t.name&&i.setAttribute("class",t.name),t.title&&i.setAttribute("title",t.title),t.title&&i.setAttribute("aria-label",t.title),i.setAttribute("tabindex","0"),i.setAttribute("focusable","true"),i.appendChild((e=t.link,(n=h("use")).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e),n)),m(i)}Object.assign(m,{div:v("div"),img:v("img"),li:v("li"),ol:v("ol"),span:v("span"),p:v("p"),i:v("i"),a:v("a"),el:c,document:l,window:u});var _={TOGGLE_OPEN:"menu:toggle:open",RENDER:"menu:render",PUSH:"menu:push"},g={ON:"fp-on",INVIS:"fp-invis"};function w(t,e){var n=window.__flowplayer_active_menu;if(n&&n.root&&n.root!==e&&n.root.toggleClass("has-menu-opened",!1),!t||!e)return n.menu=0,void(n.root=0);n.menu=t,n.root=e,n.root.toggleClass("has-menu-opened",!0)}if(!window.__flowplayer_active_menu){window.__flowplayer_active_menu={menu:0,root:0};document.addEventListener("click",(function(t){if(window.__flowplayer_active_menu){var e=window.__flowplayer_active_menu.menu,n=window.__flowplayer_active_menu.root;if(e&&n)if(document.contains(e)){if(e.hasClass(g.ON)){var i=e.parentElement;e.contains(t.target)||i.contains(t.target)||n.emit(_.TOGGLE_OPEN,{menu:e,open:!1})}}else w(null)}}))}function E(t,e,i){var o=i.id||"menu-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5);return i=i||{},t.attr("role","button").attr("aria-haspopup","true").attr("aria-expanded","false").attr("aria-controls",o).attr("aria-label",i.title),i.options=i.options||[],i.id=o,E._interface(t,e,n({},i))}function b(t,e,n,i,o){t.emit("quality:set",o._attrs.options[i])}return E.title=function(t){return m("<h3>").txt(t)},E.close=function(t){return m.span("fp-close").on("click",t).html("&times;")},E.option=function(t,e){var n=this,i=m("<li>").attr("tabindex","0").attr("role","menuitem"),o=n._attrs;t.icon&&i.append(y(t.icon)),i.append(m("<span>").txt(t.text)),i.on("click",(function(i){o.multi||n.options().forEach(E.off),n.activate(e),"function"==typeof t.onclick&&t.onclick(i,t,e,n)})),i.idx=e,n.append(i)},E._interface=function(t,e,n){t.addClass("fp-menu-container");var o=m("<ul>").attr("id",n.id).addClass("fp-menu").attr("role","menu");return n.icons&&o.addClass("fp-icons"),o._attrs=n,t.on("click",(function(t){setTimeout((function(){if(!t.defaultPrevented)return o.hasClass(g.ON)?e.emit(_.TOGGLE_OPEN,{menu:o,open:!1}):void e.emit(_.TOGGLE_OPEN,{menu:o,open:!0})}),0)})),e.on(_.TOGGLE_OPEN,(function(n){if(i(n,"data.menu")!==o)return o.toggleClass(g.ON,!1),t.attr("aria-expanded","false");var r=i(n,"data.open",!1);if(o.toggleClass(g.ON,r),r?w(o,e):w(null),t.attr("aria-expanded",r?"true":"false"),e.hasClass("is-accessibility"))if(r){var a=o.options()[0];a&&a.focus()}else t.focus()})),o.push=function(t){return o._attrs.options=i(o,"_attrs.options",[]),o._attrs.options.push(t),o.render()},o.select=function(t){return o.render(o.options.filter(t))},o.render=function(e){var n=o._attrs;return o.empty(),o.prepend(E.close()),n.title&&o.prepend(E.title(n.title)),n.options=e||n.options,n.options.forEach(E.option,o),t.toggleClass(g.INVIS,0==n.options.length),o._activate(),o},o.close=function(){o.hasClass(g.ON)&&e.emit(_.TOGGLE_OPEN,{menu:o,open:!1})},o._activate=function(){o.options().forEach((function(t){t.toggleClass(g.ON,t.idx===o.idx)}))},o.options=function(){return[].slice.call(o.querySelectorAll("li"))},o.activate=function(t,e){void 0===o.idx||o.idx!==t||e?o.idx=t:delete o.idx,o._activate()},o.deactivate=function(){o.activate(o.idx)},o.render(n.options),t.appendChild(o),o},E.on=function(t){return t.addClass(g.ON),t},E.off=function(t){return t.removeClass(g.ON),t},E.CONTAINER_CLASS="fp-menu",E.Events=_,E.States=g,function(t,e){if("object"==typeof exports&&"undefined"!=typeof module)return e;"flowplayer"in t||(t.flowplayer={extensions:[]});var n=t.flowplayer;return"function"==typeof n?(n(e),e):(Array.isArray(n.extensions)||(n.extensions=[]),~n.extensions.indexOf(e)||n.extensions.push(e),e)}(window,(function(t,e,o){if(!1!==t.qsel){var r=m.span("fp-qsel fp-menu-container").txt("HD").attr("tabindex","0"),a=E(r,e,{title:o._t("qsel.menu_title"),options:[]});o.on("mount",(function(){e.controls&&e.controls.append(r)})),o.on("qualities",(function(e){if(Array.isArray(e.data)){var r=e.data,s=i(t,"qsel.labels",[]),u=[];r.forEach((function(t,e){if("boolean"!=typeof s[e]||s[e]){var i=t.height?t.height+"p":t.text;"number"==typeof t.height&&t.height>719&&(i+=" HD"),u.push(n({},t,{text:s[e]||i,onclick:b.bind(0,o)}))}})),a.render(u)}}))}}))}));
