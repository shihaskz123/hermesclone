!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):((t="undefined"!=typeof globalThis?globalThis:t||self).flowplayer=t.flowplayer||{},t.flowplayer.subtitles_html=e())}(this,(function(){"use strict";const t=[].slice;function e(t,e,...n){return Object.assign(t,e)}function n(t,e,n){const i=function(t){return Array.isArray(t)?t.slice(0):t.split(".")}(e);for(;i.length;){if(null==t)return n;const e=i.shift();if("string"!=typeof e)return n;t=t[e]}return null==t?n:t}function i(e){return t.call(e)}function r(t,e){if(function(t){switch(t){case"":case"anonymous":case"use-credentials":return!0;default:console.warn("Invalid(crossorigin: %s) must be one of '', 'anonymous', or 'use-credentials'\nhttps://developer.mozilla.org/en-US/docs/Web/HTML/CORS_settings_attributes",t)}}(e=e||"anonymous"),t.crossOrigin!=e)return t.attr("crossorigin",e),t}function o(t){var e=document.createElement("a");return e.href=t,e.origin}function a(t,e){var n=document.createElement("track");n.className="fp-track renderable",n.kind="captions",n.id=["fp",e.lang].join("-");var i=n.track;for(var a in"string"!=typeof e.crossorigin&&function(t,e){try{return t.src.indexOf("blob:"),o(t.src)!==o(e)}catch(t){return console.error(t),!0}}(t,e.src)&&(r(t),e.crossorigin=t.attr("crossorigin")),"crossorigin"in e&&r(t,e.crossorigin),e)n[a]=e[a];return i.mode=e.default?"showing":"disabled",n.onload=function(){},i.oncuechange=function(e){t.emit(e.type,{track:e.target})},t.appendChild(n),n}const s=!!function(){let t=!1;try{const e=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassive",null,e),window.removeEventListener("testPassive",null,e)}catch(t){}return t}()&&{passive:!0},c=["touchstart","touchmove"];function u(t){var n=t;return n.emit=function(t,i,r={}){const o=function(t){const e=document.createEvent("Event");return e.initEvent(t,!1,!0),e}(t);return i&&e(o,{data:i||{}}),n.dispatchEvent(o),!1===r.return_self?o:n},n.on=function(t,e){return"string"==typeof t&&(t=t.split(" ")),t.forEach((function(t){return function(t){return~c.indexOf(t)}(t)?n.addEventListener(t,e,s):n.addEventListener(t,e)})),n},n.off=function(t,e){return n.removeEventListener(t,e),n},n.one=n.once=function(t,e){return n.on(t,(function i(r){n.off(t,i),e(r)}))},n}const l=Array.isArray,f="undefined"!=typeof window&&u(window),d="undefined"!=typeof document&&u(document),p=["span","a","em","p","i"];function m(t,e,n){var i=v(document.createElement(t));if(l(e)&&(n=e,e=!1),n||(n=[]),n&&!l(n)&&(n=[n]),n.length&&n.filter(t=>!!t).forEach(t=>i.append(t)),"object"!=typeof e)return i;for(var r in e)r in i?i[r]=e[r]:i.setAttribute(r,e[r]);return i}function v(t){return void 0===t||function(t){return t&&t.__flowplayer__}(t)?t:function(t){var e=t.tagName;t.__flowplayer__=1,t.find=function(e){var n=t.querySelector(e);return n?v(n):n},t.html=function(e){return t.innerHTML=e,t},t.empty=function(){return t.innerHTML="",t},t.offset=function(){var e={top:0,left:0},n=t;do{e.left+=n.offsetLeft||0,e.top+=n.offsetTop||0}while(n=n.offsetParent);return e},t.innerWidth=function(){var e=getComputedStyle(t);return t.clientWidth-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)};var n=t.insert=function(e,n){return n?l(n)?n.map((function(n){return t.insert(e,n)}))[0]:v(n="string"==typeof n?t.insertAdjacentHTML(e,n):t.insertAdjacentElement?t.insertAdjacentElement(e,n):t.appendChild(n)):n};return t.append=n.bind(t,"beforeend"),t.prepend=n.bind(t,"afterbegin"),t.css=function(e,n){return"object"==typeof e?(Object.entries(e).forEach(([e,n])=>t.css(e,n)),t):void 0===n&&"string"==typeof e?getComputedStyle(t)[e]:("number"==typeof n&&(n+="px"),t.style[e]=n,t)},t.show=function(){return t.css({display:~p.indexOf(e)?"inline":"block"})},t.hide=function(){return t.css({display:"none"})},t.remove=function(){var e=t.parentNode;e&&e.removeChild(t)},t.attr=function(e,n){return null==n?t.getAttribute(e):(t.setAttribute(e,n),t)},t.txt=function(e){return t.textContent=e,t},t.fp=function(e){return t.addClass("fp-"+e)},t.addClass=function(e){return e.split(" ").forEach((function(e){t.hasClass(e)||(t.className+=(t.className?" ":"")+e)})),t},t.removeClass=function(e){const n=e.split(" ");var i=t.className.split(" ");return t.className=i.filter((function(t){return!~n.indexOf(t)})).join(" "),t},t.toggleClass=function(e,n){return void 0===n&&(n=!t.hasClass(e)),n?t.addClass(e):t.removeClass(e)},t.findAll=function(e){return i(t.querySelectorAll(e))},t.hasClass=function(e){return~t.className.split(" ").indexOf(e)},t}(u(t))}function g(t,e){if("string"==typeof t&&"<"==t[0])return m(t.slice(1,-1),e);if("string"!=typeof t)return v(t);var n=e instanceof HTMLElement&&e.querySelector(".fp-"+t)||document.querySelector(t);return n?v(n):void 0}const h=t=>(e,n)=>("string"==typeof e&&(e={class:e}),m(t,e,n));function y(t){var e=g.div("fp-captions");return e.on(["click","touchend"],(function(e){t.emit(e.type)})),e.onrender=function(t){e.empty(),t.forEach((function(t){var n=document.createElement("pre");n.classList.add("fp-cue"),function(t,e){const n=t.style;w.forEach((function(i){const r=e[i],o="--caption-"+i;if(""===r||"auto"===r)return n.removeProperty(o);t.style.setProperty(o,r)}));const i="captions-align-"+e.align;Array.from(t.classList).forEach((function(n){n!=i&&("captions-vertical"==n&&e.vertical||n.startsWith("captions")&&t.classList.remove(n))})),t.classList.add(i),t.classList.toggle("captions-vertical",!!e.vertical)}(e,t),n.appendChild(t.getCueAsHTML()),e.appendChild(n)}))},e}Object.assign(g,{div:h("div"),img:h("img"),li:h("li"),ol:h("ol"),span:h("span"),p:h("p"),i:h("i"),a:h("a"),el:m,document:d,window:f});const w=["size","position"];function b(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function _(t){var e,n,i=b("svg");return i.setAttribute("viewBox",t.coords),t.name&&i.setAttribute("class",t.name),t.title&&i.setAttribute("title",t.title),t.title&&i.setAttribute("aria-label",t.title),i.setAttribute("tabindex","0"),i.setAttribute("focusable","true"),i.appendChild((e=t.link,(n=b("use")).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e),n)),g(i)}var E={TOGGLE_OPEN:"menu:toggle:open",RENDER:"menu:render",PUSH:"menu:push"},x={ON:"fp-on",INVIS:"fp-invis"};function C(t,e){var n=window.__flowplayer_active_menu;if(n&&n.root&&n.root!==e&&n.root.toggleClass("has-menu-opened",!1),!t||!e)return n.menu=0,void(n.root=0);n.menu=t,n.root=e,n.root.toggleClass("has-menu-opened",!0)}if(!window.__flowplayer_active_menu){window.__flowplayer_active_menu={menu:0,root:0};document.addEventListener("click",(function(t){if(window.__flowplayer_active_menu){var e=window.__flowplayer_active_menu.menu,n=window.__flowplayer_active_menu.root;if(e&&n)if(document.contains(e)){if(e.hasClass(x.ON)){var i=e.parentElement;e.contains(t.target)||i.contains(t.target)||n.emit(E.TOGGLE_OPEN,{menu:e,open:!1})}}else C(null)}}))}function k(t,n,i){var r=i.id||"menu-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5);return i=i||{},t.attr("role","button").attr("aria-haspopup","true").attr("aria-expanded","false").attr("aria-controls",r).attr("aria-label",i.title),i.options=i.options||[],i.id=r,k._interface(t,n,function(...t){return t.slice(1).reduce((t,n)=>e(t,n),t[0]||{})}({},i))}function O(t,e){try{var n=e.exec(t)[1];return parseFloat(n,10)}catch(t){return console.error(t),0}}return k.title=function(t){return g("<h3>").txt(t)},k.close=function(t){return g.span("fp-close").on("click",t).html("&times;")},k.option=function(t,e){var n=this,i=g("<li>").attr("tabindex","0").attr("role","menuitem"),r=n._attrs;t.icon&&i.append(_(t.icon)),i.append(g("<span>").txt(t.text)),i.on("click",(function(i){r.multi||n.options().forEach(k.off),n.activate(e),"function"==typeof t.onclick&&t.onclick(i,t,e,n)})),i.idx=e,n.append(i)},k._interface=function(t,e,i){t.addClass("fp-menu-container");var r=g("<ul>").attr("id",i.id).addClass("fp-menu").attr("role","menu");return i.icons&&r.addClass("fp-icons"),r._attrs=i,t.on("click",(function(t){setTimeout((function(){if(!t.defaultPrevented)return r.hasClass(x.ON)?e.emit(E.TOGGLE_OPEN,{menu:r,open:!1}):void e.emit(E.TOGGLE_OPEN,{menu:r,open:!0})}),0)})),e.on(E.TOGGLE_OPEN,(function(i){if(n(i,"data.menu")!==r)return r.toggleClass(x.ON,!1),t.attr("aria-expanded","false");var o=n(i,"data.open",!1);if(r.toggleClass(x.ON,o),o?C(r,e):C(null),t.attr("aria-expanded",o?"true":"false"),e.hasClass("is-accessibility"))if(o){var a=r.options()[0];a&&a.focus()}else t.focus()})),r.push=function(t){return r._attrs.options=n(r,"_attrs.options",[]),r._attrs.options.push(t),r.render()},r.select=function(t){return r.render(r.options.filter(t))},r.render=function(e){var n=r._attrs;return r.empty(),r.prepend(k.close()),n.title&&r.prepend(k.title(n.title)),n.options=e||n.options,n.options.forEach(k.option,r),t.toggleClass(x.INVIS,0==n.options.length),r._activate(),r},r.close=function(){r.hasClass(x.ON)&&e.emit(E.TOGGLE_OPEN,{menu:r,open:!1})},r._activate=function(){r.options().forEach((function(t){t.toggleClass(x.ON,t.idx===r.idx)}))},r.options=function(){return[].slice.call(r.querySelectorAll("li"))},r.activate=function(t,e){void 0===r.idx||r.idx!==t||e?r.idx=t:delete r.idx,r._activate()},r.deactivate=function(){r.activate(r.idx)},r.render(i.options),t.appendChild(r),r},k.on=function(t){return t.addClass(x.ON),t},k.off=function(t){return t.removeClass(x.ON),t},k.CONTAINER_CLASS="fp-menu",k.Events=E,k.States=x,function(t,e){if("object"==typeof exports&&"undefined"!=typeof module)return e;"flowplayer"in t||(t.flowplayer={extensions:[]});var n=t.flowplayer;return"function"==typeof n?(n(e),e):(Array.isArray(n.extensions)||(n.extensions=[]),~n.extensions.indexOf(e)||n.extensions.push(e),e)}(window,(function(t,r,o){if(function(){try{return"function"==typeof VTTCue.prototype.getCueAsHTML}catch(t){return!1}}()){var s=o._subtitles={tracks:[],textTracks:[],activeTracks:[],view:y(o),select:function(t){var e=s.activeTracks.slice(0);if(s.activeTracks.length=0,~e.indexOf(t))return s.btn.toggle(!1),s.view.onrender([]);s.btn.toggle(!0),s.activeTracks.push(t),t.mode="hidden",o.emit("cuechange",{track:t})}};e(s,function(t,e){if(0!=t.reaper){var n=g.span("fp-cc fp-menu-container").attr("tabindex","0").txt(e._t("cc.button","CC")),i=k(n,t,{title:e._t("cc.menu_title","Subtitles"),options:[]});return n.on("click",(function(t){1===i.options().length&&(t.preventDefault(),i.options().shift().emit("click"))})),n.toggle=function(t){this.toggleClass("fp-color-text",t)},t.controls&&t.controls.append(n),{btn:n,menu:i}}}(r,o)),o.on("mount",(function(){if(!r.controls)return r.ui.appendChild(s.view);r.controls.insertAdjacentElement("beforebegin",s.view),r.controls.appendChild(s.btn)})),o.on("config",(function(t){var e=n(t,"data.subtitles.tracks",[]);if(s.tracks!==e){s.tracks=e,(s.trackEles||[]).forEach((function(t){t.parentNode&&t.parentNode.removeChild(t)}));var i=s.activeTracks.slice(0);i&&s.select(i),s.menu.render([]),s.trackEles=s.tracks.map((function(t){return a(o,t)}))}})),o.textTracks.addEventListener("addtrack",(function(){var e,i=s.textTracks=Array.from(o.textTracks).filter((function(t){return~["captions","subtitles","descriptions"].indexOf(t.kind)})).map((function(t){return"showing"===t.mode&&(e=t,t.mode="disabled"),t.oncuechange=t.oncuechange||function(t){o.emit(t.type,{track:t.target})},t}));s.menu.render(i.map((function(t){return{text:t.label,onclick:s.select.bind(0,t)}}))),n(t,"subtitles.show")&&e&&(s.select(e),s.menu.activate(i.indexOf(e),!0))})),o.on("cuechange",(function(t){var e=n(t,"data.track");if(~s.activeTracks.indexOf(e)){var r=i(n(e,"activeCues",[]));s.view.onrender(r)}})),function(t){if(!(e="undefined"!=typeof document&&"undefined"!=typeof window,n=e?navigator.userAgent:"",i=/iP(hone|od)/i.test(n)&&!/iPad/.test(n)&&!/IEMobile/i.test(n),r=/Android/.test(n)&&!/Firefox/.test(n),o=/IEMobile/.test(n),a=o?O(n,/Windows Phone (\d+\.\d+)/):0,s=o?O(n,/IEMobile\/(\d+\.\d+)/):0,c=/^((?!chrome|android).)*safari/i.test(n),u=/SamsungBrowser/.test(n),l=u&&/SMART-TV/.test(n),f=i&&/FBSN\/iOS/i.test(n),d=function(){if(!e)return!1;if(document.documentMode)return document.documentMode;for(var t=9;t>3;t--){var n=document.createElement("div");if(n.innerHTML="\x3c!--[if IE "+t+"]><span></span><![endif]--\x3e",n.getElementsByTagName("span").length)return t}return!1}(),{controls:!i&&(!o||a>=8.1&&s>=11),video:function(t){return e&&document.createElement("video").canPlayType(t)},lang:e&&(window.navigator.userLanguage||window.navigator.language),android:r,iphone:i,ie:d,safari:c,ios:e&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!window.MSStream,samsung:u,samsung_tv:u&&l,fb_ios:f}).ios)return;var e,n,i,r,o,a,s,c,u,l,f,d;t.on("fullscreenenter",(function(){t._subtitles.textTracks.forEach((function(t){t.mode="hidden"===t.mode?"showing":"disabled"}))})),t.on("fullscreenexit",(function(){t._subtitles.textTracks.forEach((function(t){t.mode="showing"===t.mode?"hidden":"disabled"}))}))}(o)}}))}));
