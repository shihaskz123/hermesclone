!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):((t="undefined"!=typeof globalThis?globalThis:t||self).flowplayer=t.flowplayer||{},t.flowplayer.thumbnails=n())}(this,(function(){"use strict";function t(t){return"function"==typeof t}function n(){throw new Error("Function was expected as Argument[0]")}var e=[].slice;function r(i){if(!(this instanceof r))return new r(i);var o=this;return o.data=i,o.tap=function(){var i=e.call(arguments),a=i.shift();return a==r.lift?o.data:t(a)?(a.apply(o,[o.data].concat(i)),o):void n()},o.into=o.fmap=function(){var i=e.call(arguments),a=i.shift();return a==r.lift?o.data:t(a)?r(a.apply(o,[o.data].concat(i))):void n()},o.unwrap=function(){return o.data},o}r.of=r,r.lift=function(t){return t instanceof r?t.data:t},r._apply=r.apply=function(t,n){if(0==n.length)return t();if(1==n.length)return t(n[0]);if(2==n.length)return t(n[0],n[1]);if(3==n.length)return t(n[0],n[1],n[2]);if(4==n.length)return t(n[0],n[1],n[2],n[3]);if(5==n.length)return t(n[0],n[1],n[2],n[3],n[4]);throw new Error("Pipe._apply() does not support arity > 5")},r.maybe=function(t,n,i){return t?r._apply(n,[t].concat(e.call(arguments,2,arguments.length))):t},r.curry=function(t,n,i){return(n=n||[]).length>t.length-1?t.apply(i,n):function(){var o=n.concat(e.call(arguments));return r.curry(t,o,i)}};const i=[].slice;function o(t,n,...e){return Object.assign(t,n)}function a(...t){return t.slice(1).reduce((t,n)=>o(t,n),t[0]||{})}function u(t){return Array.isArray(t)?t.slice(0):t.split(".")}function s(t,n,e){const r=u(n);for(;r.length;){if(null==t)return e;const n=r.shift();if("string"!=typeof n)return e;t=t[n]}return null==t?e:t}function c(t,n,e){const r=(n=u(n)).pop(),i=s(t,n);return i&&r&&(i[r]=e),t}const f=!!function(){let t=!1;try{const n=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassive",null,n),window.removeEventListener("testPassive",null,n)}catch(t){}return t}()&&{passive:!0},l=["touchstart","touchmove"];function d(t){var n=t;return n.emit=function(t,e,r={}){const i=function(t){const n=document.createEvent("Event");return n.initEvent(t,!1,!0),n}(t);return e&&o(i,{data:e||{}}),n.dispatchEvent(i),!1===r.return_self?i:n},n.on=function(t,e){return"string"==typeof t&&(t=t.split(" ")),t.forEach((function(t){return function(t){return~l.indexOf(t)}(t)?n.addEventListener(t,e,f):n.addEventListener(t,e)})),n},n.off=function(t,e){return n.removeEventListener(t,e),n},n.one=n.once=function(t,e){return n.on(t,(function r(i){n.off(t,r),e(i)}))},n}const p=Array.isArray,h="undefined"!=typeof window&&d(window),m="undefined"!=typeof document&&d(document),v=["span","a","em","p","i"];function y(t,n,e){var r=A(document.createElement(t));if(p(n)&&(e=n,n=!1),e||(e=[]),e&&!p(e)&&(e=[e]),e.length&&e.filter(t=>!!t).forEach(t=>r.append(t)),"object"!=typeof n)return r;for(var i in n)i in r?r[i]=n[i]:r.setAttribute(i,n[i]);return r}function g(t){var n=t.tagName;t.__flowplayer__=1,t.find=function(n){var e=t.querySelector(n);return e?A(e):e},t.html=function(n){return t.innerHTML=n,t},t.empty=function(){return t.innerHTML="",t},t.offset=function(){var n={top:0,left:0},e=t;do{n.left+=e.offsetLeft||0,n.top+=e.offsetTop||0}while(e=e.offsetParent);return n},t.innerWidth=function(){var n=getComputedStyle(t);return t.clientWidth-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)};var e=t.insert=function(n,e){return e?p(e)?e.map((function(e){return t.insert(n,e)}))[0]:A(e="string"==typeof e?t.insertAdjacentHTML(n,e):t.insertAdjacentElement?t.insertAdjacentElement(n,e):t.appendChild(e)):e};return t.append=e.bind(t,"beforeend"),t.prepend=e.bind(t,"afterbegin"),t.css=function(n,e){return"object"==typeof n?(Object.entries(n).forEach(([n,e])=>t.css(n,e)),t):void 0===e&&"string"==typeof n?getComputedStyle(t)[n]:("number"==typeof e&&(e+="px"),t.style[n]=e,t)},t.show=function(){return t.css({display:~v.indexOf(n)?"inline":"block"})},t.hide=function(){return t.css({display:"none"})},t.remove=function(){var n=t.parentNode;n&&n.removeChild(t)},t.attr=function(n,e){return null==e?t.getAttribute(n):(t.setAttribute(n,e),t)},t.txt=function(n){return t.textContent=n,t},t.fp=function(n){return t.addClass("fp-"+n)},t.addClass=function(n){return n.split(" ").forEach((function(n){t.hasClass(n)||(t.className+=(t.className?" ":"")+n)})),t},t.removeClass=function(n){const e=n.split(" ");var r=t.className.split(" ");return t.className=r.filter((function(t){return!~e.indexOf(t)})).join(" "),t},t.toggleClass=function(n,e){return void 0===e&&(e=!t.hasClass(n)),e?t.addClass(n):t.removeClass(n)},t.findAll=function(n){return e=t.querySelectorAll(n),i.call(e);var e},t.hasClass=function(n){return~t.className.split(" ").indexOf(n)},t}function A(t){return void 0===t||function(t){return t&&t.__flowplayer__}(t)?t:g(d(t))}function b(t,n){if("string"==typeof t&&"<"==t[0])return y(t.slice(1,-1),n);if("string"!=typeof t)return A(t);var e=n instanceof HTMLElement&&n.querySelector(".fp-"+t)||document.querySelector(t);return e?A(e):void 0}const w=t=>(n,e)=>("string"==typeof n&&(n={class:n}),y(t,n,e));Object.assign(b,{div:w("div"),img:w("img"),li:w("li"),ol:w("ol"),span:w("span"),p:w("p"),i:w("i"),a:w("a"),el:y,document:m,window:h});function x(t,n){if(function(t){switch(t){case"":case"anonymous":case"use-credentials":return!0;default:console.warn("Invalid(crossorigin: %s) must be one of '', 'anonymous', or 'use-credentials'\nhttps://developer.mozilla.org/en-US/docs/Web/HTML/CORS_settings_attributes",t)}}(n=n||"anonymous"),t.crossOrigin!=n)return t.attr("crossorigin",n),t}function C(t){var n=document.createElement("a");return n.href=t,n.origin}function E(t,n){return t.querySelector("track[id='"+n+"']")}function _(t,n){var e=b(document.createElement("track"));return a(e,n),function(t,n){try{return t.src.indexOf("blob:"),C(t.src)!==C(n)}catch(t){return console.error(t),!0}}(t,n.src)&&(t.setAttribute("poster","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII="),x(t),x(e)),t.appendChild(e)}var k=/#xywh=(\d+),(\d+),(\d+),(\d+)$/,T=/^(https:|https:|\/)/;function j(t,n){for(t=t.slice(0);t.length;){var e=t.shift();if(e.startTime<=n&&n<=e.endTime)return e}}var O={h:"height",w:"width",x:"x",y:"y"};function L(t,n){if(0!=t.length)return~t.match(k)?function(t){var n=t.indexOf("#"),e=t.slice(0,n),r=t.slice(n+1,t.length).split("="),i=r[0].split(""),o=r[1].split(",");return i.reduce((function(t,n,e){return c(t,O[n],o[e])}),{path:e})}(t):a({},n,{path:t})}function S(t){return t.removeClass("with-thumbnail"),t.removeAttribute("style")}function M(t,n,e,r){var i=r.find(".fp-timeline").offsetWidth,o=parseInt(t.width,10),a=o/2,u=Math.round(i*(e/100))-a,s=Math.min(i-o,Math.max(u,0));return n.addClass("with-thumbnail").css({backgroundImage:["url(",t.path,")"].join(""),backgroundPositionX:"-"+t.x+"px",backgroundPositionY:"-"+t.y+"px",height:t.height+"px",width:t.width+"px",left:s+"px",marginTop:"-"+t.height+"px"})}var N=[].slice,P="thumbnails";function q(t){var n=E(t,P);n&&n.remove(),t.reaper.put(P,[])}return function(t,n){if("object"==typeof exports&&"undefined"!=typeof module)return n;"flowplayer"in t||(t.flowplayer={extensions:[]});var e=t.flowplayer;return"function"==typeof e?(e(n),n):(Array.isArray(e.extensions)||(e.extensions=[]),~e.extensions.indexOf(n)||e.extensions.push(n),n)}(window,(function(t,n,e){e.reaper.put("thumbnails",[]),e.one("mount",(function(){!function(t){var n={vod:s(t,"_behavior.kinds.vod.tooltip_update"),live:s(t,"_behavior.kinds.live.tooltip_update")},e=function(t,e,r,i){S(r.timestamp),n[i].apply(this,arguments),e.emit("thumbnails:render",a({},t,{controls:r}))};c(t,"_behavior.kinds.vod.tooltip_update",e),c(t,"_behavior.kinds.live.tooltip_update",e)}(e)})),e.on("thumbnails:render",(function(i){var o=s(i,"data.controls"),a=s(i,"data.percent");if(o&&"number"==typeof a){var u=r.of(e.duration*(a/100)).fmap(Math.min,e.duration).fmap(Math.max,0).unwrap();r.of(e.thumbnails).fmap(j,u).fmap(s,"src","").fmap(L,s(t,"thumbnails",{})).fmap(r.maybe,M,o.timestamp,a,n)}})),e.textTracks.onaddtrack=function(t){var n=t.track;if(n.id===P){var r=E(e,P);r&&(r.onload=r.onerror=function(t){if("error"==t.type)return console.error(t.type,t);c(e,"thumbnails",N.call(n.cues).map((function(t){return function(t,n){return{src:t.text.match(T)?t.text:function(t,n){const e=n.split("/");return e.pop(),e.push(t),e.join("/")}(t.text,n),endTime:t.endTime,startTime:t.startTime}}(t,r.src)})))},n.mode="hidden")}},e.on("config",(function(t){var n=s(t.data,"thumbnails.src",!1);if("string"==typeof n)return function(t,n){if(!function(t,n){return t.querySelector("track[src='"+n+"']")}(t,n))return q(t),new _(t,{kind:"metadata",src:n,id:P})}(e,n);var r=s(t.data,"thumbnails.thumbs",!1);return Array.isArray(r)?function(t,n){q(t),t.reaper.put(P,n)}(e,r):void 0}))}))}));
